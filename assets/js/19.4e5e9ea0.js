(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{538:function(s,a,n){"use strict";n.r(a);var t=n(7),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"yapi"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yapi"}},[s._v("#")]),s._v(" YApi")]),s._v(" "),n("p",[s._v("介绍：旨在为开发、产品、测试人员提供更优雅的接口管理服务。可以帮助开发者轻松创建、发布、维护 API")]),s._v(" "),n("h2",{attrs:{id:"前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),n("p",[s._v("在考虑多方面因素下，选择了YApi作为前后端API沟通的管理服务，简单说说原因，在API设计方面，考虑过很多，有以下几个：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("Swagger")])]),s._v(" "),n("li",[n("p",[s._v("Postman+Coding")])]),s._v(" "),n("li",[n("p",[s._v("ApiPost")])]),s._v(" "),n("li",[n("p",[s._v("Rap2")])])]),s._v(" "),n("p",[s._v("但是这些都有着一些让我无法忍受的问题，以下都是个人想法，也可能是我没有找到对应问题的解决办法。")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("Swagger是通过在代码中写注释或者引入文件来自动生成API文档，要去学习Swagger的文档语言，不是可视化的操作。")])]),s._v(" "),n("li",[n("p",[s._v("Postman是API接口设计测试神器，但是他们的API文档只能通过网页来保存与查看，并且他们的response不支持参数的注释介绍，也就是只有返回结果，但是不能自定义每个返回参数的含义，除非单独在json结果中添加注释。")])]),s._v(" "),n("li",[n("p",[s._v("ApiPost是国人开发的，功能和PostMan很类似，是我使用最久的，虽然软件内还有一些小问题，但是对于Postman以上两点有极大的改善，不仅文档能导出Markdown和word，并且response的结果可以自动导出键值对并且对其进行注释。不过在使用了几个月后让我放弃的原因就是安全问题，他们的隐私政策中并未提到是如何保存我的接口数据的，并且我如果要生成文档，就一定要分享接口或者目录，这个分享链接默认是开放的，类似于Postman的publish document，但是Postman可以只在团队中分享，并且分享是很严格需要确定的，然而ApiPost的分享只要点击一下，我的这个接口就开放了，我如果没有及时关闭，我甚至都找不到我以往分享了哪一些接口，其实这些不能算是严格的安全问题，最重要的是ApiPost团队可以不经过我的允许查看我的所有接口数据（这是亲身实践确定，这一点就说明了我在他们的数据库数据完全是未加密的，因为我习惯在设计API时也将设计文档写在一起方便查看，但如果是明文数据，那么我还是很排斥的，所以在这之后我就选择了大团队或开源软件以保证我数据的安全性）")])]),s._v(" "),n("li",[n("p",[s._v("Rap2界面难受")])])]),s._v(" "),n("p",[s._v("YApi解决了postman的问题，而且开源可以内网部署，暂时是我完美的选择方案。")]),s._v(" "),n("h2",{attrs:{id:"环境要求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[s._v("#")]),s._v(" 环境要求")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("nodejs（7.6+)")])]),s._v(" "),n("li",[n("p",[s._v("mongodb（2.6+）")])])]),s._v(" "),n("h2",{attrs:{id:"服务器系统"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器系统"}},[s._v("#")]),s._v(" 服务器系统")]),s._v(" "),n("ul",[n("li",[s._v("Ubuntu 18.04.4")])]),s._v(" "),n("h2",{attrs:{id:"安装环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装环境"}},[s._v("#")]),s._v(" 安装环境")]),s._v(" "),n("ul",[n("li",[s._v("nodejs安装")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('sudo apt install nodejs\n\nsudo apt install npm\n\n// 这里注意这样下载的node版本很可能是非常古老的，需要更新为最新的版本\n\n// 首先查看版本（可以和node官网比对一下版本号，最好是LTS稳定版本）\nnode -v\n\n// 如果版本太老，就需要安装n模块来更新node\nnpm install -g n\n\n// 安装版本二选一\n// 安装稳定版本\nn stable\n\n// 安装最新版本\nn latest\n\n// npm升级\nnpm install npm -g\n// 如果要指定版本，可以通过@指定版本\nnpm install npm@3.10.10 -g \n\n// 注意，此处的node与npm的版本还需调用-v查看，如果仍然为旧版本就是环境变量路径问题\n\n需要调用\npath="$path"\n解决\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("安装mongodb（该流程完全按照官方文档走）")]),s._v(" "),n("ul",[n("li",[s._v("官方链接：")])])])]),s._v(" "),n("p",[n("a",{attrs:{href:"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Install MongoDB Community Edition on Ubuntu — MongoDB Manual"),n("OutboundLink")],1)]),s._v(" "),n("ol",[n("li",[s._v("Import the public key used by the package management system，导入公钥")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("wget -qO - https://www.mongodb.org/static/pgp/server-4.4.asc | sudo apt-key add -\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",[n("li",[s._v("Create a list file for MongoDB，建文件夹")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.4 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.4.list\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",[n("li",[s._v("Reload local package database，更新apt")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sudo apt-get update\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",[n("li",[s._v("Install the MongoDB packages，开始安装mongo")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('sudo apt-get install -y mongodb-org\n\n// To prevent unintended upgrades\necho "mongodb-org hold" | sudo dpkg --set-selections\necho "mongodb-org-server hold" | sudo dpkg --set-selections\necho "mongodb-org-shell hold" | sudo dpkg --set-selections\necho "mongodb-org-mongos hold" | sudo dpkg --set-selections\necho "mongodb-org-tools hold" | sudo dpkg --set-selections\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ol",[n("li",[s._v("Follow these steps to run MongoDB Community Edition on your system，一些mongo命令")])]),s._v(" "),n("ul",[n("li",[s._v("Start MongoDB，开启mongo服务")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sudo systemctl start mongod\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("Verify that MongoDB has started successfully，查看mongo状态")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sudo systemctl status mongod\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("Stop MongoDB，关闭mongo")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sudo systemctl stop mongod\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("Restart MongoDB，重启mongo")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sudo systemctl restart mongod\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("Begin using MongoDB，命令行使用mongo")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongo\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"安装yapi"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装yapi"}},[s._v("#")]),s._v(" 安装YApi")]),s._v(" "),n("ol",[n("li",[s._v("可视化部署")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 该命令需要root权限，并且时间会有点长\nnpm install -g yapi-cli --registry https://registry.npm.taobao.org\n\nyapi server\n\n// 之后根据提示访问地址通过网页配置\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ol",[n("li",[s._v("PM2守护服务进程")])]),s._v(" "),n("ul",[n("li",[s._v("PM2官方文档")])]),s._v(" "),n("p",[n("a",{attrs:{href:"https://pm2.keymetrics.io/docs/usage/quick-start/",target:"_blank",rel:"noopener noreferrer"}},[s._v("PM2 - Quick Start"),n("OutboundLink")],1)]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm install pm2@latest -g\n\n// 进入安装好的my-yapi文件夹，依次进入my-yapi/vendors/server，然后执行\npm2 start app.js\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);